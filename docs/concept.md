# Concept

Neweb - это клиент-серверный фреймворк, позволяющий создавать сайты с поддержкой современных технологий: обновление данных реального времени, React-компоненты, автоматическая доставка кода в браузер.
Neweb - это нечто среднее между SPA (Single Page Application) и классическими серверными сайтами.

Приложение Neweb все так же состоит из страниц, как и обычный сайт, отдает контент по http-запросу с поддержкой SEO-технологий. А после этого включается real-time приложение с обменом данными по websocket-соединению. Дальнейшая навигация для пользователя происходит мгновенно, без перезагрузки страницы, с обновлением только меняющихся частей.

При этом, в отличии от SPA, код отвечающий за бизнес-логику, за формирование данных и их обработку, находится на сервере. Код на клиенте отвечает лишь за отображение страницы, обработку событий пользователя и других возможностей браузера (например, push-уведомления).

### Основные возможности

- Обновление данных на клиенте в режиме реального времени с помощью websocket.

- Автоматическая передача кода на клиент, кэширование модулей на клиенте, версионирование. Загрузка только тех модулей, которые необходимы в данный момент. Параллельная загрузка модулей.

- Скрытие бизнес-логики, код для получения и обработки данных находится на сервере.

- Серверный рендеринг, поддержка SEO.

- Универсальная навигация с заменой только изменяющихся частей страницы. Навигация реального времени (например, автоматический редирект на всех страницах при разлогинивании пользователя).

- Пользовательская сессия с хранением произвольных данных и подпиской на их обновления.

### Загрузка кода на клиент

У нас есть прекрасные пакетные менеджеры с поддержкой инкрементального версионирования. Например, в Npm пакет не может измениться после публикации. Это позволяет кэшировать пакеты навечно. Браузеры могли бы хранить в кэше большую часть npm-репозитария. Мы могли бы запрашивать пакеты у браузера локально, но пока этого нет. Сейчас эту задачу решают CDN, но пакеты в них все так же собираются в большие bundle.
Neweb реализует свою систему кэширования модулей на клиенте. Каждый модуль грузится на клиент для каждого приложения только один раз. При навигации догружаются только необходимые модули. Более подробно в разделе "Модули".

### Выполнение кода на клиенте и на сервере

В начале web-а код на клиенте отвечал только за отрисовку html, простейшие события с помощью javascript и отправку форм на сервер. Но скорость работы оставляла желать лучшего, переход на новый URL требовал грузить заново целую страницу. Возникла необходимость обновлять страницу частично, с помощью Ajax или Websocket. Но тогда возникла проблема с двойной шаблонизацией, нам нужно было уметь генерировать html как на клиенте, так и на сервере. Тогда этот вопрос решить не удалось и возникли SPA - приложения, где html полностью генерировался и обрабатывался только на клиенте.

При этом туда же пришлось перенести большую часть бизнес-логики, а с ней и необходимость иметь на клиенте множество функций для работы с данными. К тому же потребность в серверном рендеринге никуда не исчезло, поисковые системы все так же работают в основном на классическом понимании сайтов. Да и отрисовка в браузере гораздо быстрее, если html сгенерирован заранее.

Neweb обращается к истоками и возвращает бизнес-логику на сервер. Мы предполагаем, что современные приложения - это в большей части своей онлайн-приложения и технологии позволяют поддерживать соединение между клиентом и сервером без ограничений. Поэтому клиентская часть приложения служит лишь для отрисовки страницы и ожидании действий от пользователя, информацию о которых тут же шлет на сервер, где и принимаюся все дальнейшие решения.

